import serial, time, csv, datetime

try
    ser = serial.Serial(port='COM4', baudrate=9600, bytesize=8, parity='N', stopbits=1, timeout=2, xonxoff=False,
                        rtscts=False, dsrdtr=False)
    print(Com port is active)
except
    print(Com port isnt active)

serial.Serial.reset_output_buffer(ser)  # clears input

global array1
global array2
global array3
array1 = []
array2 = []
array3 = []

printtocvs = input('Write to csv y or n  ')


# print(printtocvs)

def recordandprintdata()
    if printtocvs == 'y'
        with open('candatatry1.csv', 'w', newline='', encoding='utf8') as csvfile
            # fieldnames = ['ThrottlePos', 'Lateral Acc', 'RPM']  # defining Columns of csv
            t = datetime.datetime.now()
            writer = csv.writer(csvfile, delimiter=',')
            writer.writerow(['ThrottlePos', 'Lateral Acc', 'RPM', t.strftime(%H%M%S)])  # Writing the headers to csv
            for _ in ser
                t = datetime.datetime.now()
                # t = t.strftime(%H%M%S)
                data = ser.readline()
                data = data.decode('utf-8')
                print(data)
                # array1.append(data(1))
                # array2.append(data(2))
                # array3.append(data(3))
                writer.writerows([data])

    else
        for _ in ser
            t = datetime.datetime.now()
            data = ser.readline()
            data = data.decode('utf-8')
            print(data)
            # array1.append(data(1))
            # array2.append(data(2))
            # array3.append(data(3))
            #print(t.strftime(%H%M%S))
            ###

recordandprintdata()